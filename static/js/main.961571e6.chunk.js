(this["webpackJsonpspeedrun-pb-graph"]=this["webpackJsonpspeedrun-pb-graph"]||[]).push([[0],{225:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(36),s=a.n(c),o=a(16),u=a(7),i=a(10),l=a.n(i),j=a(9),b=a(18),d=a(6),m=a(12),O=a.n(m),g=a(104),h=(a(217),a(14)),p=a(227),f=a(73),x=a(2),v=function(e){var t=e.error;return Object(x.jsxs)(f.a,{variant:"danger",children:["An error occured: ",t]})},y=function(){return Object(x.jsx)(f.a,{variant:"info",children:"Loading..."})},N=function(e){var t=e%1,a=Math.floor(e)%60,r=Math.floor(e/60)%60,n=Math.floor(e/3600),c=0===t?"":t.toFixed(3).slice(1),s=a<10?"0".concat(a):"".concat(a),o=r<10?"0".concat(r):"".concat(r),u=0===n?"":"".concat(n,":");return"".concat(u).concat(o,":").concat(s).concat(c)},I=function(e){var t=e.isIL,a=Object(u.h)(),n=a.userId,c=a.categoryId,s=a.levelId,i=Object(r.useRef)(null),m=new URLSearchParams(Object(u.g)().search),f=Object(r.useState)(!0),I=Object(d.a)(f,2),S=I[0],w=I[1],k=Object(r.useState)(!1),C=Object(d.a)(k,2),V=C[0],F=C[1],P=Object(r.useState)(""),D=Object(d.a)(P,2),M=D[0],L=D[1],E=Object(r.useState)(""),B=Object(d.a)(E,2),G=B[0],J=B[1],A=Object(r.useState)(""),K=Object(d.a)(A,2),R=K[0],T=K[1],H=Object(r.useState)(""),U=Object(d.a)(H,2),z=U[0],W=U[1],_=Object(r.useState)(""),Q=Object(d.a)(_,2),X=Q[0],Y=Q[1],Z=Object(r.useState)(""),$=Object(d.a)(Z,2),ee=$[0],te=$[1],ae=Object(r.useState)([]),re=Object(d.a)(ae,2),ne=re[0],ce=re[1],se=function(){var e=Object(b.a)(l.a.mark((function e(){var a,r,o,u,i,g,p,f,x,v,y,N,I,S,k;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([O()("".concat(q,"/categories/").concat(c,"?embed=game"),{timeout:3e4}),O()("".concat(q,"/users/").concat(n),{timeout:3e4}),t?O()("".concat(q,"/runs?user=").concat(n,"&level=").concat(s,"&category=").concat(c,"&max=200"),{timeout:3e4}):O()("".concat(q,"/runs?user=").concat(n,"&category=").concat(c,"&max=200"),{timeout:3e4})]);case 3:return a=e.sent,r=Object(d.a)(a,3),o=r[0],u=r[1],i=r[2],e.next=10,Promise.all([o.json(),u.json(),i.json()]);case 10:if(g=e.sent,p=Object(d.a)(g,3),f=p[0],x=p[1],v=p[2],y=null,!t){e.next=24;break}return e.next=19,O()("".concat(q,"/levels/").concat(s));case 19:return S=e.sent,e.next=22,S.json();case 22:y=e.sent,te(null!==(N=null===(I=y)||void 0===I?void 0:I.data.name)&&void 0!==N?N:"");case 24:return e.next=26,Promise.all(Object(j.a)(m.entries()).map(function(){var e=Object(b.a)(l.a.mark((function e(t){var a,r,n,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(d.a)(t,2),r=a[0],n=a[1],e.next=3,O()("".concat(q,"/variables/").concat(r));case 3:return c=e.sent,e.next=6,c.json();case 6:return s=e.sent,e.abrupt("return",s.data.values.values[n].label);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 26:k=e.sent.join(", "),J(f.data.game.data.names.international),T(f.data.name),Y(k),W(x.data.names.international),w(!1),ce(v.data.filter((function(e){return"rejected"!==e.status.status})).filter((function(e){return Object.entries(e.values).every((function(e){var t=Object(d.a)(e,2),a=t[0];return t[1]===m.get(a)}))})).map((function(e){return{date:h.DateTime.fromFormat(e.date,"yyyy-MM-dd",{zone:"UTC"}),time:e.times.primary_t,id:e.id}})).sort((function(e,t){return e.date===t.date?e.time<t.time?-1:1:e.date<t.date?-1:1}))),e.next=40;break;case 35:e.prev=35,e.t0=e.catch(0),F(!0),L(e.t0.message),console.error(e.t0);case 40:case"end":return e.stop()}}),e,null,[[0,35]])})));return function(){return e.apply(this,arguments)}}();if(Object(r.useEffect)((function(){se()}),[]),V)return Object(x.jsx)(v,{error:M});if(S)return Object(x.jsx)(y,{});var oe={labels:ne.map((function(e){return e.date})),datasets:[{label:"Time",data:ne.map((function(e){return e.time})),borderColor:"rgb(255,0,0)"}]},ue={onClick:function(){var e=i.current.getActiveElements();if(e.length>0){var t=ne[e[0].index];window.location.href="https://speedrun.com/run/".concat(t.id)}},responsive:!0,scales:{x:{type:"time",time:{tooltipFormat:"MMM d, yyyy"}},y:{ticks:{callback:function(e){return N(e)}}}},plugins:{tooltip:{callbacks:{label:function(e){return N(e.parsed.y)}}}}};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("h1",{children:[G," : ",t?ee+" ":""," ",R," - ",X?X+" - ":"",z]}),Object(x.jsx)(o.b,{to:"/user/".concat(n),children:"Back to user"}),Object(x.jsx)("p",{children:Object(x.jsx)("b",{children:" Click a data-point to see the associated run's speedrun.com page!"})}),Object(x.jsx)(p.a,{children:Object(x.jsx)(g.a,{ref:i,type:"line",data:oe,options:ue})})]})},S=a(228),w=a(101),k=a(72),C=a(100),V=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),a=t[0],n=t[1],c=Object(u.f)();return Object(x.jsx)(k.a,{inline:!0,onSubmit:function(e){e.preventDefault(),c.push("/search/".concat(a))},children:Object(x.jsxs)(C.a,{children:[Object(x.jsx)(k.a.Control,{type:"search",name:"username",id:"searchInput",placeholder:"speedrun.com username",value:a,onChange:function(e){e.preventDefault(),n(e.target.value)}}),Object(x.jsx)(w.a,{type:"submit",children:Object(x.jsx)(S.a,{})})]})})},F=function(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("h1",{children:" Welcome to the Speedrun PB Grapher"}),Object(x.jsx)("h3",{children:" Enter your username to get started!"}),Object(x.jsx)(V,{})]})},P=a(102),D=function(e){var t=e.category,a=e.userID,r=t.subcategories.map((function(e){return"".concat(e.subcategoryKeyId,"=").concat(e.subcategoryValueId)})).join("&"),n=t.subcategories.map((function(e){return e.subcategoryValueName})).join(", ");return Object(x.jsx)("li",{children:Object(x.jsxs)(o.b,{to:"/graph/".concat(a,"/").concat(t.categoryId,"?").concat(r),children:[t.categoryName," ",t.subcategories.length>0?"- ".concat(n):""]})})},M=function(e){var t=e.category,a=e.userID,r=t.subcategories.map((function(e){return"".concat(e.subcategoryKeyId,"=").concat(e.subcategoryValueId)})).join("&"),n=t.subcategories.map((function(e){return e.subcategoryValueName})).join(", ");return Object(x.jsx)("li",{children:Object(x.jsxs)(o.b,{to:"/graph/il/".concat(a,"/").concat(t.levelId,"/").concat(t.categoryId,"?").concat(r),children:[t.levelName," ",t.categoryName," ",t.subcategories.length>0?"- ".concat(n):""]})})},L=function(e){var t=e.game,a=e.userData;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("h1",{children:[" ",t.name," "]}),t.fullGameCategories.length>0?Object(x.jsx)("h2",{children:"Full game runs:"}):Object(x.jsx)(x.Fragment,{}),Object(x.jsx)("ul",{children:t.fullGameCategories.map((function(e){return Object(x.jsx)(D,{category:e,userID:a.id},JSON.stringify(e))}))}),t.levelCategories.length>0?Object(x.jsx)("h2",{children:"IL runs:"}):Object(x.jsx)(x.Fragment,{}),Object(x.jsx)("ul",{children:t.levelCategories.map((function(e){return Object(x.jsx)(M,{category:e,userID:a.id},JSON.stringify(e))}))})]})},E=function(){var e=Object(b.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object.entries(t).map(function(){var e=Object(b.a)(l.a.mark((function e(t){var a,r,n,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(d.a)(t,2),r=a[0],n=a[1],e.next=3,O()("".concat(q,"/variables/").concat(r));case 3:return c=e.sent,e.next=6,c.json();case 6:return s=e.sent,e.abrupt("return",{subcategoryKeyId:r,subcategoryValueId:n,subcategoryValueName:s.data.values.values[n].label});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(b.a)(l.a.mark((function e(t,a,r,n,c){var s,o,u,i,m,g,h,p,f,x,v,y,N,I;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([O()("".concat(q,"/users/").concat(t),{timeout:3e4}),O()("".concat(q,"/users/").concat(t,"/personal-bests?embed=game,category,level"),{timeout:3e4})]);case 3:return s=e.sent,o=Object(d.a)(s,2),u=o[0],i=o[1],e.next=9,Promise.all([u.json(),i.json()]);case 9:return m=e.sent,g=Object(d.a)(m,2),h=g[0],p=g[1],f=Object(P.groupBy)(p.data,(function(e){return e.category.data.type})),x=f["per-game"],v=f["per-level"],e.next=18,Promise.all(x.map(function(){var e=Object(b.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.game.data.names.international,e.t1=t.game.data.id,e.t2=t.category.data.name,e.t3=t.category.data.id,e.next=6,E(t.run.values);case 6:return e.t4=e.sent,e.abrupt("return",{gameName:e.t0,gameId:e.t1,categoryName:e.t2,categoryId:e.t3,subcategories:e.t4});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 18:return y=e.sent.sort((function(e,t){return e.categoryName<t.categoryName?-1:e.categoryName>t.categoryName?1:0==e.subcategories.length?0:e.subcategories[0].subcategoryValueName<t.subcategories[0].subcategoryValueName?-1:e.subcategories[0].subcategoryValueName>t.subcategories[0].subcategoryValueName?1:0})),e.next=21,Promise.all(v.map(function(){var e=Object(b.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.game.data.names.international,e.t1=t.game.data.id,e.t2=t.category.data.name,e.t3=t.category.data.id,e.t4=t.level.data.id,e.t5=t.level.data.name,e.next=8,E(t.run.values);case 8:return e.t6=e.sent,e.abrupt("return",{gameName:e.t0,gameId:e.t1,categoryName:e.t2,categoryId:e.t3,levelId:e.t4,levelName:e.t5,subcategories:e.t6});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 21:N=e.sent.sort((function(e,t){return e.levelName<t.levelName?-1:e.levelName>t.levelName?1:e.categoryName<t.categoryName?-1:e.categoryName>t.categoryName?1:0==e.subcategories.length?0:e.subcategories[0].subcategoryValueName<t.subcategories[0].subcategoryValueName?-1:e.subcategories[0].subcategoryValueName>t.subcategories[0].subcategoryValueName?1:0})),I=Object(j.a)(new Set(p.data.map((function(e){return{id:e.game.data.id,name:e.game.data.names.international,fullGameCategories:[],levelCategories:[]}})))).map((function(e){var t=e.id,a=e.name;return{id:t,name:a,fullGameCategories:y.filter((function(e){return e.gameId===t})),levelCategories:N.filter((function(e){return e.gameId===t}))}})),c({id:h.data.id,name:h.data.names.international,games:I}),a(!1),e.next=32;break;case 27:e.prev=27,e.t0=e.catch(0),r(!0),n(e.t0.message),console.error(e.t0);case 32:case"end":return e.stop()}}),e,null,[[0,27]])})));return function(t,a,r,n,c){return e.apply(this,arguments)}}(),G=function(){var e=Object(u.h)().id,t=Object(r.useState)(!0),a=Object(d.a)(t,2),n=a[0],c=a[1],s=Object(r.useState)(!1),o=Object(d.a)(s,2),i=o[0],l=o[1],j=Object(r.useState)(""),b=Object(d.a)(j,2),m=b[0],O=b[1],g=Object(r.useState)(null),h=Object(d.a)(g,2),p=h[0],f=h[1];return Object(r.useEffect)((function(){B(e,c,l,O,f)}),[]),i?Object(x.jsx)(v,{error:m}):n?Object(x.jsx)(y,{}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("h2",{children:["Categories for ",null===p||void 0===p?void 0:p.name]}),null===p||void 0===p?void 0:p.games.map((function(e){return Object(x.jsx)(L,{game:e,userData:p},e.id)}))]})},J=a(103),A=a(231),K=a(230),R=(a(224),function(){var e=Object(r.useState)([]),t=Object(d.a)(e,2),a=t[0],n=t[1],c=Object(u.h)().query,s=Object(r.useState)(!1),i=Object(d.a)(s,2),j=i[0],m=i[1],g=Object(r.useState)(""),h=Object(d.a)(g,2),p=h[0],f=h[1],N=Object(r.useState)(!0),I=Object(d.a)(N,2),S=I[0],w=I[1],k=Object(r.useState)(null),C=Object(d.a)(k,2),V=C[0],F=C[1],P=function(){var e=Object(b.a)(l.a.mark((function e(){var t,a,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O()("".concat(q,"/users?lookup=").concat(c),{timeout:3e4});case 3:return t=e.sent,e.next=6,t.json();case 6:return(a=e.sent).data.length>0&&F({id:a.data[0].id,name:a.data[0].names.international}),e.next=10,O()("".concat(q,"/users?name=").concat(c),{timeout:3e4});case 10:return r=e.sent,e.next=13,r.json();case 13:s=e.sent,n(s.data.map((function(e){return{id:e.id,name:e.names.international}}))),w(!1),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(0),console.error(e.t0),m(!0),f("Error ".concat(p," occurred"));case 23:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){P()}),[c]),j?Object(x.jsx)(v,{error:p}):S?Object(x.jsx)(y,{}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("h3",{children:["Results for ",c,":"]}),Object(x.jsxs)("ul",{children:[V&&Object(x.jsx)("p",{children:Object(x.jsxs)("b",{children:["An exact match was found: ",Object(x.jsxs)(o.b,{to:"/user/".concat(V.id),children:[V.name," "]})]})}),a.length>0?a.map((function(e){var t=e.id,a=e.name;return Object(x.jsx)("li",{children:Object(x.jsxs)(o.b,{to:"/user/".concat(t),children:[a," "]})},t)})):Object(x.jsxs)("p",{children:["No users found. ",Object(x.jsx)(o.b,{to:"/",children:"Search again?"})]})]})]})}),T=a(229),q="https://speedrun.com/api/v1",H=function(){return Object(x.jsxs)(o.a,{children:[Object(x.jsxs)(A.a,{bg:"dark",expand:"lg",className:"mb-4",style:{justifyContent:"space-between"},children:[Object(x.jsxs)(K.a,{children:[Object(x.jsx)(A.a.Brand,{href:"#/",style:{color:"white"},children:"Speedrun PB Grapher"}),Object(x.jsx)(K.a.Link,{href:"#/",style:{color:"white"},children:"Home"})]}),Object(x.jsxs)(K.a,{className:"float-right",children:[Object(x.jsx)(V,{}),Object(x.jsx)(K.a.Link,{href:"https://github.com/Hurricane996/speedrun-pb-graph",children:Object(x.jsx)(T.a,{style:{color:"white"},className:"ml-auto"})})]})]}),Object(x.jsx)(J.a,{children:Object(x.jsxs)(u.c,{children:[Object(x.jsx)(u.a,{path:"/user/:id",exact:!0,children:Object(x.jsx)(G,{})}),Object(x.jsx)(u.a,{path:"/graph/il/:userId/:levelId/:categoryId",exact:!0,children:Object(x.jsx)(I,{isIL:!0})}),Object(x.jsx)(u.a,{path:"/graph/:userId/:categoryId",exact:!0,children:Object(x.jsx)(I,{isIL:!1})}),Object(x.jsx)(u.a,{path:"/search/:query",exact:!0,children:Object(x.jsx)(R,{})}),Object(x.jsx)(u.a,{path:"/",exact:!0,children:Object(x.jsx)(F,{})}),Object(x.jsx)(u.a,{children:"404"})]})})]})};s.a.render(Object(x.jsx)(n.a.StrictMode,{children:Object(x.jsx)(H,{})}),document.getElementById("root"))}},[[225,1,2]]]);
//# sourceMappingURL=main.961571e6.chunk.js.map