(this["webpackJsonpspeedrun-pb-graph"]=this["webpackJsonpspeedrun-pb-graph"]||[]).push([[0],{204:function(e,t,a){},205:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),c=a(80),s=a.n(c),o=a(9),i=a(2),u=a(3),l=a.n(u),d=a(5),j=a(4),b=a(8),h=a(87),m=(a(198),a(12)),p=a(29),f=a.n(p),g=a(0),v=function(e){var t=e.error;return Object(g.jsxs)("div",{className:"".concat(f.a.alert," ").concat(f.a.error),children:["An error occured: ",t]})},x=function(){return Object(g.jsx)("div",{className:"".concat(f.a.alert," ").concat(f.a.loading),children:"Loading..."})},O=function(e){var t=e%1,a=Math.floor(e)%60,r=Math.floor(e/60)%60,n=Math.floor(e/3600),c=t<.001?"":t.toFixed(3).slice(1),s=a<10?"0".concat(a):"".concat(a),o=r<10?"0".concat(r):"".concat(r),i=0===n?"":"".concat(n,":");return"".concat(i).concat(o,":").concat(s).concat(c)},y=a(83),N=a.n(y),I=a(20),_=Object(r.createContext)(null),w=function(e){var t=e.children,a=Object(r.useState)({}),n=Object(j.a)(a,2),c=n[0],s=n[1];return Object(g.jsx)(_.Provider,{value:{isInCache:function(e){return Object.keys(c).includes(e)},getFromCache:function(e){return c[e]},addOrUpdateCache:function(e,t){var a=Object(I.a)({},c);a[e]=t,s(a)}},children:t})},C=function(e,t,a){var n=Object(r.useState)(null),c=Object(j.a)(n,2),s=c[0],o=c[1],i=Object(r.useState)(!0),u=Object(j.a)(i,2),d=u[0],h=u[1],m=Object(r.useState)(null),p=Object(j.a)(m,2),f=p[0],g=p[1],v=Object(r.useContext)(_);if(!v)return[null,!1,"calls to useFetcher() must be wrapped in a CacheProvider"];var x=v.isInCache,O=v.addOrUpdateCache,y=v.getFromCache,I=function(){var e=Object(b.a)(l.a.mark((function e(t){var a,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.replace(X,""),!x(a)){e.next=3;break}return e.abrupt("return",y(a));case 3:return e.next=5,N()(t,{timeout:1e4});case 5:return r=e.sent,e.next=8,r.json();case 8:return n=e.sent,O(a,n),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var a=Object(b.a)(l.a.mark((function a(){var r;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return h(!0),a.prev=1,a.next=4,e(t,I);case 4:r=a.sent,o(r),h(!1),a.next=13;break;case 9:a.prev=9,a.t0=a.catch(1),console.error(a.t0),g(a.t0.message);case 13:case"end":return a.stop()}}),a,null,[[1,9]])})));return function(){return a.apply(this,arguments)}}();return Object(r.useEffect)((function(){w()}),null!==a&&void 0!==a?a:[]),[s,d,f]},k=function(e,t,a){return a?e?t+e:"":e?e+t:""},S=a(84),P=a.n(S),A=function(){var e=Object(b.a)(l.a.mark((function e(t,a){var r,n,c,s,o,i,u,h,p,f,g,v;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.userId,n=t.categoryId,c=t.levelId,s=t.searchParams,e.next=3,Promise.all([a("".concat(X,"/categories/").concat(n,"?embed=game")),a("".concat(X,"/users/").concat(r)),a("".concat(X,"/runs?user=").concat(r).concat(k(c,"&level=",!0),"&category=").concat(n,"&max=200")),c?a("".concat(X,"/levels/").concat(c)):null,Promise.all(Object(d.a)(s.entries()).map(function(){var e=Object(b.a)(l.a.mark((function e(t){var r,n,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(j.a)(t,2),n=r[0],c=r[1],e.next=3,a("".concat(X,"/variables/").concat(n));case 3:return s=e.sent,e.abrupt("return",s.data.values.values[c].label);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))]);case 3:return o=e.sent,i=Object(j.a)(o,5),u=i[0],h=i[1],p=i[2],f=i[3],g=i[4],v=p.data.filter((function(e){return"rejected"!==e.status.status})).filter((function(e){return Object.entries(e.values).every((function(e){var t=Object(j.a)(e,2),a=t[0];return t[1]===s.get(a)}))})).map((function(e){return{date:m.DateTime.fromFormat(e.date,"yyyy-MM-dd",{zone:"UTC"}),time:e.times.primary_t,id:e.id}})).sort((function(e,t){return e.date===t.date?e.time<t.time?-1:1:e.date<t.date?-1:1})),e.abrupt("return",{gameName:u.data.game.data.names.international,categoryName:u.data.name,subcategoryString:g.join(", "),username:h.data.names.international,levelName:f?f.data.name:"",runs:v});case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),M=function(){var e=Object(i.h)(),t=e.userId,a=e.categoryId,n=e.levelId,c=Object(r.useRef)(null),s=new URLSearchParams(Object(i.g)().search);if(!t)return Object(g.jsx)(v,{error:"No user id provided!"});if(!a)return Object(g.jsx)(v,{error:"No category id provided!"});var u=C(A,{userId:t,categoryId:a,levelId:n,searchParams:s}),l=Object(j.a)(u,3),d=l[0],b=l[1],m=l[2];if(m)return Object(g.jsx)(v,{error:m});if(b)return Object(g.jsx)(x,{});var p={labels:null===d||void 0===d?void 0:d.runs.map((function(e){return e.date})),datasets:[{label:"Time",data:null===d||void 0===d?void 0:d.runs.map((function(e){return e.time})),borderColor:"rgb(255,0,0)"}]},f={onClick:function(){if(c.current){var e=c.current.getActiveElements();if(e.length>0){var t=null===d||void 0===d?void 0:d.runs[e[0].index];window.location.href="https://speedrun.com/run/".concat(null===t||void 0===t?void 0:t.id)}}},responsive:!0,scales:{x:{type:"time",time:{tooltipFormat:"MMM d, yyyy"}},y:{ticks:{callback:function(e){return O(e)}}}},plugins:{tooltip:{callbacks:{label:function(e){return O(e.parsed.y)}}}}};return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("h1",{children:[null===d||void 0===d?void 0:d.gameName,": ",k(null===d||void 0===d?void 0:d.levelName," "),null===d||void 0===d?void 0:d.categoryName," - ",k(null===d||void 0===d?void 0:d.subcategoryString," - "),null===d||void 0===d?void 0:d.username]}),Object(g.jsx)(o.b,{to:"/user/".concat(t),children:"Back to user"}),Object(g.jsx)("p",{children:Object(g.jsx)("b",{children:" Click a data-point to see the associated run's speedrun.com page!"})}),Object(g.jsx)("div",{className:P.a.chartContainer,children:Object(g.jsx)(h.a,{ref:c,type:"line",data:p,options:f})})]})},F=a(86),G=a(30),L=a.n(G),V=a.p+"static/media/search.43904a2f.svg",B=function(){var e=Object(r.useState)(""),t=Object(j.a)(e,2),a=t[0],n=t[1],c=Object(i.f)();return Object(g.jsxs)("form",{onSubmit:function(e){e.preventDefault(),c.push("/search/".concat(a))},className:L.a.form,children:[Object(g.jsx)("input",{type:"search",name:"username",id:Object(F.uniqueId)("search-field-"),placeholder:"speedrun.com username",value:a,onChange:function(e){e.preventDefault(),n(e.target.value)},className:L.a.searchInput}),Object(g.jsx)("button",{type:"submit","aria-label":"search",className:L.a.searchButton,children:Object(g.jsx)("img",{src:V,className:L.a.searchIcon})})]})},U=function(){return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("h1",{children:" Welcome to the Speedrun PB Grapher"}),Object(g.jsx)("p",{children:" Enter your username to get started!"}),Object(g.jsx)(B,{})]})},q=function(){var e=Object(b.a)(l.a.mark((function e(t,a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object.entries(t).map(function(){var e=Object(b.a)(l.a.mark((function e(t){var r,n,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(j.a)(t,2),n=r[0],c=r[1],e.next=3,a("".concat(X,"/variables/").concat(n));case 3:return s=e.sent,e.abrupt("return",{subcategoryKeyId:n,subcategoryValueId:c,subcategoryValueName:s.data.values.values[c].label});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),D=function(e,t){if(e.categoryName<t.categoryName)return-1;if(e.categoryName>t.categoryName)return 1;if(0===e.subcategories.length||0===t.subcategories.length)return 0;if(e.subcategories[0].subcategoryValueName<t.subcategories[0].subcategoryValueName)return-1;if(e.subcategories[0].subcategoryValueName>t.subcategories[0].subcategoryValueName)return 1;if("levelName"in e&&"levelName"in t){if(e.levelName<t.levelName)return-1;if(e.levelName>t.levelName)return 1}return 0},H=function(){var e=Object(b.a)(l.a.mark((function e(t,a){var r,n,c,s,o,i,u,h,m,p,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,e.next=3,Promise.all([a("".concat(X,"/users/").concat(r)),a("".concat(X,"/users/").concat(r,"/personal-bests?embed=game,category,level"))]);case 3:return n=e.sent,c=Object(j.a)(n,2),s=c[0],o=c[1],i=o.data.filter((function(e){return"per-game"===e.category.data.type})),u=o.data.filter((function(e){return"per-level"===e.category.data.type})),e.next=11,Promise.all(i.map(function(){var e=Object(b.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.game.data.names.international,e.t1=t.game.data.id,e.t2=t.category.data.name,e.t3=t.category.data.id,e.next=6,q(t.run.values,a);case 6:return e.t4=e.sent,e.abrupt("return",{gameName:e.t0,gameId:e.t1,categoryName:e.t2,categoryId:e.t3,subcategories:e.t4});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:return h=e.sent,e.next=14,Promise.all(u.map(function(){var e=Object(b.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.game.data.names.international,e.t1=t.game.data.id,e.t2=t.category.data.name,e.t3=t.category.data.id,e.t4=t.level.data.id,e.t5=t.level.data.name,e.next=8,q(t.run.values,a);case 8:return e.t6=e.sent,e.abrupt("return",{gameName:e.t0,gameId:e.t1,categoryName:e.t2,categoryId:e.t3,levelId:e.t4,levelName:e.t5,subcategories:e.t6});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 14:return m=e.sent,p=Object(d.a)(new Set(o.data.map((function(e){return e.game.data.id})))),f=p.map((function(e){var t=h.filter((function(t){return t.gameId===e})).sort(D),a=m.filter((function(t){return t.gameId===e})).sort(D);return{id:e,name:t.length>0?t[0].gameName:a[0].gameName,fullGameCategories:t,levelCategories:a}})),e.abrupt("return",{id:s.data.id,name:s.data.names.international,games:f});case 18:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),J=function(e){return e.length?"?"+e.map((function(e){return"".concat(e.subcategoryKeyId,"=").concat(e.subcategoryValueId)})).join("&"):""},Q=function(e){return e.length?" - "+e.map((function(e){return e.subcategoryValueName})).join(", "):""},R=function(){var e=Object(i.h)().id,t=C(H,{id:e}),a=Object(j.a)(t,3),r=a[0],c=a[1],s=a[2];return s?Object(g.jsx)(v,{error:s}):c?Object(g.jsx)(x,{}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("h1",{children:["Categories for ",null===r||void 0===r?void 0:r.name]}),r&&r.games.length>0?r.games.map((function(e){return Object(g.jsxs)(n.a.Fragment,{children:[Object(g.jsxs)("h2",{children:[" ",e.name," "]}),e.fullGameCategories.length>0&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("h3",{children:"Full game runs:"}),Object(g.jsx)("ul",{children:e.fullGameCategories.map((function(e){return Object(g.jsx)("li",{children:Object(g.jsxs)(o.b,{to:"/graph/".concat(r.id,"/").concat(e.categoryId).concat(J(e.subcategories)),children:[e.categoryName,Q(e.subcategories)]})},JSON.stringify(e))}))})]}),e.levelCategories.length>0&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("h3",{children:"IL runs:"}),Object(g.jsx)("ul",{children:e.levelCategories.map((function(e){return Object(g.jsx)("li",{children:Object(g.jsxs)(o.b,{to:"/graph/il/".concat(r.id,"/").concat(e.levelId,"/").concat(e.categoryId,"?").concat(J(e.subcategories)),children:[e.levelName," ",e.categoryName,Q(e.subcategories)]})},JSON.stringify(e))}))})]})]},e.id)})):Object(g.jsx)("p",{children:"This user hasn't submitted any runs"})]})},T=function(){var e=Object(b.a)(l.a.mark((function e(t,a){var r,n,c,s,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.query,n=t.offset,e.next=3,Promise.all([a("".concat(X,"/users?lookup=").concat(r)),a("".concat(X,"/users?name=").concat(r,"&offset=").concat(n))]);case 3:return c=e.sent,s=Object(j.a)(c,2),o=s[0],i=s[1],e.abrupt("return",{exactMatch:o.data.length>0?{id:o.data[0].id,name:o.data[0].names.international}:null,results:i.data.map((function(e){return{id:e.id,name:e.names.international}})),hasNext:!!i.pagination.links.find((function(e){return"next"==e.rel}))});case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),E=function(){var e=Object(i.h)().query,t=new URLSearchParams(Object(i.g)().search).get("offset"),a=t?parseInt(t):0,r=C(T,{query:e,offset:a},[e,a]),n=Object(j.a)(r,3),c=n[0],s=n[1],u=n[2];return u?Object(g.jsx)(v,{error:u}):s?Object(g.jsx)(x,{}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("h2",{children:["Results for ",e,":"]}),(null===c||void 0===c?void 0:c.exactMatch)&&Object(g.jsx)("p",{children:Object(g.jsxs)("b",{children:["An exact match was found: ",Object(g.jsxs)(o.b,{to:"/user/".concat(c.exactMatch.id),children:[c.exactMatch.name," "]})]})}),(null===c||void 0===c?void 0:c.results)&&c.results.length>0?Object(g.jsx)("ul",{children:c.results.map((function(e){var t=e.id,a=e.name;return Object(g.jsx)("li",{children:Object(g.jsxs)(o.b,{to:"/user/".concat(t),children:[a," "]})},t)}))}):Object(g.jsxs)("p",{children:["No users found. ",Object(g.jsx)(o.b,{to:"/",children:"Search again?"})]}),a>0&&Object(g.jsx)(o.b,{to:"/search/".concat(e,"?offset=").concat(Math.max(0,a-20)),children:"<Prev"}),a>0&&(null===c||void 0===c?void 0:c.hasNext)&&" - ",(null===c||void 0===c?void 0:c.hasNext)&&Object(g.jsx)(o.b,{to:"/search/".concat(e,"?offset=").concat(a+20),children:"Next >"})]})},K=a(25),z=a.n(K),W=a.p+"static/media/githubLogo.3359e022.svg",X="https://speedrun.com/api/v1",Z=function(){return Object(g.jsx)(o.a,{children:Object(g.jsxs)(w,{children:[Object(g.jsxs)("div",{className:z.a.navbar,children:[Object(g.jsx)("div",{children:Object(g.jsx)(o.c,{to:"/",className:z.a.navHeader,children:"Speedrun PB Grapher"})}),Object(g.jsx)("span",{className:z.a.rightAligner,children:Object(g.jsx)(B,{})}),Object(g.jsx)("a",{"aria-label":"Project Github",href:"https://github.com/Hurricane996/speedrun-pb-graph",children:Object(g.jsx)("img",{src:W,className:z.a.githubLogo})})]}),Object(g.jsx)("div",{className:z.a.container,children:Object(g.jsxs)(i.c,{children:[Object(g.jsx)(i.a,{path:"/user/:id",exact:!0,children:Object(g.jsx)(R,{})}),Object(g.jsx)(i.a,{path:"/graph/il/:userId/:levelId/:categoryId",exact:!0,children:Object(g.jsx)(M,{})}),Object(g.jsx)(i.a,{path:"/graph/:userId/:categoryId",exact:!0,children:Object(g.jsx)(M,{})}),Object(g.jsx)(i.a,{path:"/search/:query",exact:!0,children:Object(g.jsx)(E,{})}),Object(g.jsx)(i.a,{path:"/",exact:!0,children:Object(g.jsx)(U,{})}),Object(g.jsx)(i.a,{children:"404"})]})})]})})};a(204);s.a.render(Object(g.jsx)(n.a.StrictMode,{children:Object(g.jsx)(Z,{})}),document.getElementById("root"))},25:function(e,t,a){e.exports={container:"App_container__1MQN3",navbar:"App_navbar__3gDlA",githubLogo:"App_githubLogo__QiF9o",navHeader:"App_navHeader__3dfmH",rightAligner:"App_rightAligner__2j8kQ"}},29:function(e,t,a){e.exports={alert:"Alerts_alert__M7JDU",error:"Alerts_error__3Q1Kj",loading:"Alerts_loading__3ZTON"}},30:function(e,t,a){e.exports={form:"SearchComponent_form__nyAGw",searchInput:"SearchComponent_searchInput__3mkng",searchButton:"SearchComponent_searchButton__3vePQ",searchIcon:"SearchComponent_searchIcon__uesRg"}},84:function(e,t,a){e.exports={chartContainer:"GraphPage_chartContainer__3hmoX"}}},[[205,1,2]]]);
//# sourceMappingURL=main.18849f5b.chunk.js.map